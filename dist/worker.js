!function(t){function e(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,a){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"c",function(){return r}),n.d(e,"b",function(){return s}),n.d(e,"e",function(){return o}),n.d(e,"f",function(){return u}),n.d(e,"h",function(){return c}),n.d(e,"g",function(){return h}),n.d(e,"d",function(){return p});var a=n(1),i=32,r=i*i,s=i*i*i,o=6,u=2400,c=2,h=Uint32Array.BYTES_PER_ELEMENT*c,d=(Uint32Array.BYTES_PER_ELEMENT,{T:{name:"TOP",id:0,axis:1,axisDelta:1,verts:[0,1,1,1,1,1,1,1,0,0,1,0],dx:0,dy:1,dz:0,size:i,deltaIndex:1},B:{name:"BOTTOM",id:1,axis:1,axisDelta:-1,verts:[0,0,0,1,0,0,1,0,1,0,0,1],dx:0,dy:-1,dz:0,size:i,deltaIndex:-1},N:{name:"NORTH",id:2,axis:2,axisDelta:1,verts:[1,0,1,1,1,1,0,1,1,0,0,1],dx:0,dy:0,dz:1,size:i,deltaIndex:i},S:{name:"SOUTH",id:3,axis:2,axisDelta:-1,verts:[0,0,0,0,1,0,1,1,0,1,0,0],dx:0,dy:0,dz:-1,size:i,deltaIndex:-i},E:{name:"EAST",id:4,axis:0,axisDelta:1,verts:[1,0,0,1,1,0,1,1,1,1,0,1],dx:1,dy:0,dz:0,size:i,deltaIndex:r},W:{name:"WEST",id:5,axis:0,axisDelta:-1,verts:[0,0,1,0,1,1,0,1,0,0,0,0],dx:-1,dy:0,dz:0,size:i,deltaIndex:-r}});for(var f in d){var l=d[f];l.deltaV3=new a.a(l.dx,l.dy,l.dz)}d.T.tangents=[{side:d.N,tangents:[d.E,d.W]},{side:d.E,tangents:[d.S,d.N]},{side:d.S,tangents:[d.W,d.E]},{side:d.W,tangents:[d.N,d.S]}],d.B.tangents=[{side:d.S,tangents:[d.W,d.E]},{side:d.E,tangents:[d.S,d.N]},{side:d.N,tangents:[d.E,d.W]},{side:d.W,tangents:[d.N,d.S]}],d.N.tangents=[{side:d.E,tangents:[d.T,d.B]},{side:d.T,tangents:[d.E,d.W]},{side:d.W,tangents:[d.B,d.T]},{side:d.B,tangents:[d.W,d.E]}],d.S.tangents=[{side:d.W,tangents:[d.B,d.T]},{side:d.T,tangents:[d.E,d.W]},{side:d.E,tangents:[d.T,d.B]},{side:d.B,tangents:[d.W,d.E]}],d.E.tangents=[{side:d.S,tangents:[d.T,d.B]},{side:d.T,tangents:[d.N,d.S]},{side:d.N,tangents:[d.B,d.T]},{side:d.B,tangents:[d.S,d.N]}],d.W.tangents=[{side:d.N,tangents:[d.B,d.T]},{side:d.T,tangents:[d.N,d.S]},{side:d.S,tangents:[d.T,d.B]},{side:d.B,tangents:[d.S,d.N]}],d.T.opposite=d.B,d.B.opposite=d.T,d.N.opposite=d.S,d.S.opposite=d.N,d.E.opposite=d.W,d.W.opposite=d.E;var p={byName:{TOP:d.T,BOTTOM:d.B,NORTH:d.N,SOUTH:d.S,EAST:d.E,WEST:d.W},byId:[d.T,d.B,d.N,d.S,d.E,d.W],byAxis:[[d.E,d.W],[d.T,d.B],[d.N,d.S]],each:function(t){for(var e=0;e<6;e+=1)t(p.byId[e])}}},function(t,e,n){"use strict";var a=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.a=new Float32Array([t,e,n])}return Object.defineProperty(t.prototype,"x",{get:function(){return this.a[0]},set:function(t){this.a[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.a[1]},set:function(t){this.a[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this.a[2]},set:function(t){this.a[2]=t},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.a[0],this.a[1],this.a[2])},t.prototype.set=function(t,e,n){return this.a[0]=t,this.a[1]=e,this.a[2]=n,this},t.prototype.setFrom=function(t){return this.a[0]=t.a[0],this.a[1]=t.a[1],this.a[2]=t.a[2],this},t.prototype.setSum=function(t,e){return this.a[0]=t.a[0]+e.a[0],this.a[1]=t.a[1]+e.a[1],this.a[2]=t.a[2]+e.a[2],this},t.prototype.toString=function(){return this.a[0]+","+this.a[1]+","+this.a[2]},Object.defineProperty(t.prototype,"id",{get:function(){return this.a[0]+","+this.a[1]+","+this.a[2]},enumerable:!0,configurable:!0}),t.prototype.lengthSqr=function(){var t=this.a[0],e=this.a[1],n=this.a[2];return t*t+e*e+n*n},t.prototype.length=function(){return Math.sqrt(this.lengthSqr())},t.prototype.ceil=function(){return this.a[0]=Math.ceil(this.a[0]),this.a[1]=Math.ceil(this.a[1]),this.a[2]=Math.ceil(this.a[2]),this},t.prototype.floor=function(){return this.a[0]=Math.floor(this.a[0]),this.a[1]=Math.floor(this.a[1]),this.a[2]=Math.floor(this.a[2]),this},t.prototype.negate=function(){return this.a[0]=-this.a[0],this.a[1]=-this.a[1],this.a[2]=-this.a[2],this},t.prototype.invert=function(){return this.a[0]=1/this.a[0],this.a[1]=1/this.a[1],this.a[2]=1/this.a[2],this},t.prototype.normalize=function(){var t=this.lengthSqr();return t>0&&this.multiplyScalar(1/Math.sqrt(t)),this},t.prototype.multiplyScalar=function(t){return this.a[0]*=t,this.a[1]*=t,this.a[2]*=t,this},t.prototype.divideScalar=function(t){return this.a[0]/=t,this.a[1]/=t,this.a[2]/=t,this},t.prototype.add=function(t){return this.a[0]+=t.a[0],this.a[1]+=t.a[1],this.a[2]+=t.a[2],this},t.prototype.subtract=function(t){return this.a[0]-=t.a[0],this.a[1]-=t.a[1],this.a[2]-=t.a[2],this},t.prototype.multiply=function(t){return this.a[0]*=t.a[0],this.a[1]*=t.a[1],this.a[2]*=t.a[2],this},t.prototype.divide=function(t){return this.a[0]/=t.a[0],this.a[1]/=t.a[1],this.a[2]/=t.a[2],this},t.prototype.dot=function(t){return this.a[0]*t.a[0]+this.a[1]*t.a[1]+this.a[2]*t.a[2]},t.prototype.cross=function(t){var e=this.a[0],n=this.a[1],a=this.a[2],i=t.a[0],r=t.a[1],s=t.a[2];return this.a[0]=n*s-a*r,this.a[1]=a*i-e*s,this.a[2]=e*r-n*i,this},t.prototype.lerp=function(t,e){var n=this.a[0],a=this.a[1],i=this.a[2];return this.a[0]=a+e*(t.a[0]-n),this.a[1]=i+e*(t.a[1]-a),this.a[2]=n+e*(t.a[2]-i),this},t.prototype.exactEquals=function(t){return this.a[0]===t.a[0]&&this.a[1]===t.a[1]&&this.a[2]===t.a[2]},t.prototype.equals=function(t){var e=this.a[0],n=this.a[1],a=this.a[2],i=t.a[0],r=t.a[1],s=t.a[2];return Math.abs(e-i)<=1e-6*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(n-r)<=1e-6*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(a-s)<=1e-6*Math.max(1,Math.abs(a),Math.abs(s))},t}();e.a=a},function(t,e,n){"use strict";var a=function(){function t(t,e){this.createCallback=t,this.releaseCallback=e,this.items=[]}return t.prototype.acquire=function(){return this.items.length?this.items.pop():this.createCallback()},t.prototype.release=function(t){this.releaseCallback&&this.releaseCallback(t),this.items.push(t)},t}();e.a=a},function(t,e,n){"use strict";function a(t,e){var n=s.byId.length,a=new r(n,t,e);return s.byId[n]=a,s.byName[t]=a,a}var i=n(0).d,r=function(){function t(t,e,n){var a=this;this.id=t,this.name=e,this.textureSides=[],i.each(function(t){a.textureSides[t.id]=a.makeTextureSide(n)})}return t.prototype.setSideTile=function(t,e){return this.textureSides[t.id]=this.makeTextureSide(e),this},t.prototype.makeTextureSide=function(t){return[t%16,Math.floor(t/16)]},t}(),s={byId:[],byName:{}};e.a=s,a("air",0),a("stone",1),a("dirt",2),a("grass",3).setSideTile(i.byName.TOP,0).setSideTile(i.byName.BOTTOM,2),a("planks",4),a("brick",7),a("cobble",16),a("bedrock",17),a("sand",18),a("gravel",19),a("wood",20).setSideTile(i.byName.TOP,21).setSideTile(i.byName.BOTTOM,21),a("gold_ore",32),a("iron_ore",33),a("coal_ore",34),a("mossy_cobble",36),a("obsidian",37),a("diamond_ore",50),a("redstone_ore",51),a("stone_brick",54),a("snow",66),a("ice",67),a("snowy_grass",68).setSideTile(i.byName.TOP,66).setSideTile(i.byName.BOTTOM,2),a("fungus",77).setSideTile(i.byName.TOP,78).setSideTile(i.byName.BOTTOM,2),a("mossy_stone_brick",100),a("cracked_stone_brick",101),a("sandstone",192).setSideTile(i.byName.TOP,176).setSideTile(i.byName.BOTTOM,176)},function(t,e,n){"use strict";function a(){return new r.a(function(){return new Uint32Array(i.f*i.g)})}var i=n(0),r=n(2);e.a={mainPool:a(),acquire:function(){return this.mainPool.acquire()},release:function(t){this.mainPool.release(t)},createPrefilledPool:function(t){var e=a();return e.items=t,e}}},function(t,e,n){"use strict";var a=n(0),i=n(2),r=n(1),s=function(){function t(){this.pos=new r.a,this.id="NaN,NaN,NaN",this.blocks=new Uint8Array(a.b)}return t.prototype.setChunkPos=function(t){this.pos.setFrom(t),this.id=t.toString()},t.pool=new i.a(function(){return new t}),t}();e.a=s},function(t,e,n){"use strict";function a(){for(;u.length>0&&c.length>0;){var t=c.shift(),e=u.pop();t.assignedWorkerId=e.workerId,i(e,t)}}function i(t,e){var n=e.onStart();if(n){var i=n.requestPayload,r=n.transferableObjects;s[e.taskId]=e,t.start(e.taskId,e.taskType,i,r,function(n){delete s[e.taskId],u.push(t),a(),e.cancelled?e.onCancelled(n):e.onComplete(n)})}}e.b=function(t,e,n,i){var s=r+=1,o={taskId:s,taskType:t,onStart:e,onComplete:n,onCancelled:i};return c.push(o),a(),s},e.a=function(t){for(var e,n=0;n<c.length;n+=1){var a=c[n];if(a.taskId===t){e=a,c.splice(n,1);break}}if(e)return!0;var i=s[t];return i&&(o[i.assignedWorkerId].cancel(),i.cancelled=!0),!1};!function(){function t(t,e){var n=this;this.worker=t,this.workerId=e,this.worker.addEventListener("message",function(t){var e=t.data;if(e.taskId===n.activeTaskId&&n.onResponse){var a=n.onResponse;n.onResponse=void 0,a(e)}})}t.prototype.start=function(t,e,n,a,i){this.onResponse=i,this.activeTaskId=t,this.activeTaskType=e,n.taskId=t,n.taskType=e,this.worker.postMessage(n,a)},t.prototype.cancel=function(){this.worker.postMessage({cancelTask:this.activeTaskId})}}();var r=0,s={},o=[],u=[],c=[]},function(t,e,n){"use strict";function a(t,e){for(var n=[0,0,0,0],a=0;a<4;a+=1){var i=e.tangents[a].side;if(d.setAdjacentToBlockPos(t,i),d.blockDataSource){d.isTransparent()||(n[a]+=2,n[(a+1)%4]+=2);var r=e.tangents[(a+1)%4].side;f.setAdjacentToBlockPos(d,r),f.blockDataSource&&(f.isTransparent()||(n[(a+1)%4]+=1))}}for(var s=0;s<4;s+=1)n[s]=h[n[s]];return n}var i=n(0),r=n(3),s=n(11),o=n(12),u=n(4),c=n(1),h=[1,.7,.7,.6,.5,.5],d=new s.a(void 0,new c.a(0,0,0)),f=new s.a(void 0,new c.a(0,0,0)),l=function(){function t(t,e,n){this.blockData=t,this.quadIdsByBlockAndSide=e,this.vertexArrayPool=n,this.quadCount=0,this.vertexArrays=[],this.currentVertexArray=void 0}return t.prototype.addVertexArray=function(){var t=new Uint32Array(this.vertexArrayPool.acquire());return this.vertexArrays.push(t),t},t.prototype.addQuad=function(t,e,n,a){var r=this.quadCount;this.quadCount+=1,this.quadCount>this.vertexArrays.length*i.f&&(this.currentVertexArray=this.addVertexArray()),o.a(this.currentVertexArray,r%i.f,t,e,n,a),this.quadIdsByBlockAndSide[6*t.i+e.id]=r+1},t.prototype.drawInternalChunkQuads=function(){var t=this,e=new s.a(void 0,new c.a(0,0,0),this.blockData),n=new s.a(void 0,new c.a(0,0,0),this.blockData);e.eachBlockInChunk(function(){e.isTransparent()||i.d.each(function(i){if(n.setAdjacentToBlockPos(e,i),n.blockDataSource&&n.isTransparent()){var s=r.a.byId[t.blockData[e.i]].textureSides[i.id],o=a(n,i);t.addQuad(e,i,s,o)}})})},t}();e.a={drawInternalChunkQuads:function(t,e,n){void 0===n&&(n=[]);var a=u.a.createPrefilledPool(n),i=new l(t,e,a);return i.drawInternalChunkQuads(),{quadCount:i.quadCount,vertexArrays:i.vertexArrays,unusedVertexArrays:a.items}},unstitchChunk:function(t,e){var n=new s.a;n.eachBlockOnFace(t,e,function(){t.removeQuad(n,e)})},stitchChunks:function(t){function e(t,e){if(t.getQuadId(e)>=0){var n=t.getBlockData(),i=r.a.byId[n].textureSides[e.id];o.setAdjacentToBlockPos(t,e);var s=a(o,e);t.engineChunk.updateQuadAO(t,e,i,s)}}function n(t,e,n){var i=t.getBlockData(),s=r.a.byId[i].textureSides[n.id],o=a(e,n);t.engineChunk.addQuad(t,n,s,o)}for(var o=new s.a(void 0,new c.a(0,0,0)),u=new s.a,h=new s.a,d=0;d<3;d+=1)for(var f=function(a){var r=i.d.byAxis[d][a],s=t.neighboursBySideId[r.id];if(s){u.eachBlockOnFace(t,r,function(){h.setAdjacentToBlockPos(u,r);var t=u.isTransparent(),a=h.isTransparent();!t&&a?n(u,h,r):!a&&t&&n(h,u,r.opposite);for(var i=0;i<r.tangents.length;i+=1){var s=r.tangents[i].side;e(u,s),e(h,s)}});for(var o=d+1;o<3;o+=1)for(var c=function(t){var n=i.d.byAxis[o][t],a=s.neighboursBySideId[n.id];if(a&&(h.eachBlockOnEdge(a,r,n,function(){e(h,r.opposite),e(h,n.opposite);var t=3-r.axis-n.axis;e(h,i.d.byAxis[t][0]),e(h,i.d.byAxis[t][1])}),2!==o))for(var u=0;u<2;u+=1){var c=i.d.byAxis[2][u],d=a.neighboursBySideId[c.id];d&&(h.setBlockOnCorner(d,r,n,c),e(h,r.opposite),e(h,n.opposite),e(h,c.opposite))}},f=0;f<2;f+=1)c(f)}},l=0;l<2;l+=1)f(l)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(9),i=n(10),r=n(13);a.a([i.a,r.a])},function(t,e,n){"use strict";e.a=function(t){var e,n,a=self,i={};t.forEach(function(t){i[t.id]=t}),a.addEventListener("message",function(t){var r=t.data;r.cancelTask||(e?console.error("Worker was messaged to start a new task before finishing the previous task!?"):(e=r.taskId,n=r.taskType,i[n].work(r,function(t,i){t.taskId=e,e=void 0,n=void 0,a.postMessage(t,i)})))})}},function(t,e,n){"use strict";var a=n(5),i=n(6),r=n(7),s=n(4);e.a={id:"TaskDrawInternalVerts",cancel:function(t){i.a(t)},queue:function(t,e,n){return i.b("TaskDrawInternalVerts",function(){var n=e.acquire(),a=[s.a.acquire()];return{requestPayload:{blockData:t.blocks.buffer,quadIdsByBlockAndSide:n.buffer,initialVertexArrays:a.map(function(t){return t.buffer})},transferableObjects:[t.blocks.buffer,n.buffer].concat(a.map(function(t){return t.buffer}))}},function(e){t.blocks=new Uint8Array(e.blockData),e.unusedVertexArrays.map(function(t){return new Uint32Array(t)}).forEach(function(t){s.a.release(t)}),n(e.quadCount,e.vertexArrays.map(function(t){return new Uint32Array(t)}),new Uint16Array(e.quadIdsByBlockAndSide))},function(n){t.blocks=new Uint8Array(n.blockData),a.a.pool.release(t);var i=new Uint16Array(n.quadIdsByBlockAndSide);n.unusedVertexArrays.map(function(t){return new Uint32Array(t)}).forEach(function(t){s.a.release(t)}),n.vertexArrays.map(function(t){return new Uint32Array(t)}).forEach(function(t){s.a.release(t)}),e.release(i)})},work:function(t,e){var n=new Uint8Array(t.blockData),a=new Uint16Array(t.quadIdsByBlockAndSide),i=t.initialVertexArrays.map(function(t){return new Uint32Array(t)});a.fill(0);var s=r.a.drawInternalChunkQuads(n,a,i),o=s.quadCount,u=s.vertexArrays,c=s.unusedVertexArrays;e({blockData:n.buffer,quadCount:o,vertexArrays:u.map(function(t){return t.buffer}),quadIdsByBlockAndSide:a.buffer,unusedVertexArrays:c.map(function(t){return t.buffer})},[n.buffer,a.buffer].concat(u.map(function(t){return t.buffer}),c.map(function(t){return t.buffer})))}}},function(t,e,n){"use strict";var a=n(0),i=n(1),r=n(3),s=function(){function t(t,e,n){this.engineChunk=t,this.pos=e?e.clone():new i.a,this.blockDataOverride=n,this.recalculateIndex()}return t.prototype.clone=function(){return new t(this.engineChunk,this.pos)},t.prototype.recalculateIndex=function(){var t=this.pos.a;this.i=t[0]*a.c+t[2]*a.a+t[1]},Object.defineProperty(t.prototype,"blockDataSource",{get:function(){return this.engineChunk?this.engineChunk.chunkData.blocks:this.blockDataOverride},enumerable:!0,configurable:!0}),t.prototype.getQuadId=function(t){return this.engineChunk?this.engineChunk.quadIdsByBlockAndSide[6*this.i+t.id]-1:-1},t.prototype.getWorldPoint=function(t){t.setFrom(this.engineChunk.worldPos).multiplyScalar(a.a).add(this.pos)},t.prototype.getBlockData=function(){return this.engineChunk?this.engineChunk.chunkData.blocks[this.i]:this.blockDataOverride?this.blockDataOverride[this.i]:0},t.prototype.getBlockType=function(){return r.a.byId[this.getBlockData()]},t.prototype.isOpaque=function(){return 0!==this.getBlockData()},t.prototype.isTransparent=function(){return 0===this.getBlockData()},t.prototype.setAdjacentToBlockPos=function(t,e){this.pos.setFrom(t.pos),this.engineChunk=t.engineChunk,this.blockDataOverride=t.blockDataOverride;var n=t.pos.a[e.axis]+e.axisDelta,i=t.i+e.deltaIndex;if(n<0||n>=a.a){if(this.engineChunk)if(this.engineChunk.neighboursBySideId){var r=this.engineChunk.neighboursBySideId[e.id];this.engineChunk=r}else this.engineChunk=void 0;else this.blockDataOverride=void 0;n+=a.a*-e.axisDelta,i+=a.a*-e.deltaIndex}this.pos.a[e.axis]=n,this.i=i},t.prototype.add=function(t,e,n){if(e>0)for(this.pos.a[1]+=e;this.pos.a[1]>a.a-1;)if(this.engineChunk=this.engineChunk.neighboursBySideId[a.d.byName.TOP.id],this.pos.a[1]-=a.a,!this.engineChunk)return;if(e<0)for(this.pos.a[1]+=e;this.pos.a[1]<0;)if(this.engineChunk=this.engineChunk.neighboursBySideId[a.d.byName.BOTTOM.id],this.pos.a[1]+=a.a,!this.engineChunk)return;if(n>0)for(this.pos.a[2]+=n;this.pos.a[2]>a.a-1;)if(this.engineChunk=this.engineChunk.neighboursBySideId[a.d.byName.NORTH.id],this.pos.a[2]-=a.a,!this.engineChunk)return;if(n<0)for(this.pos.a[2]+=n;this.pos.a[2]<0;)if(this.engineChunk=this.engineChunk.neighboursBySideId[a.d.byName.SOUTH.id],this.pos.a[2]+=a.a,!this.engineChunk)return;if(t>0)for(this.pos.a[0]+=t;this.pos.a[0]>a.a-1;)if(this.engineChunk=this.engineChunk.neighboursBySideId[a.d.byName.EAST.id],this.pos.a[0]-=a.a,!this.engineChunk)return;if(t<0)for(this.pos.a[0]+=t;this.pos.a[0]<0;)if(this.engineChunk=this.engineChunk.neighboursBySideId[a.d.byName.WEST.id],this.pos.a[0]+=a.a,!this.engineChunk)return;this.recalculateIndex()},t.prototype.eachBlockInChunk=function(t){var e=this.pos.a;for(this.i=0,e[0]=0;e[0]<a.a;e[0]+=1)for(e[2]=0;e[2]<a.a;e[2]+=1)for(e[1]=0;e[1]<a.a;e[1]+=1)t(),this.i+=1},t.prototype.eachBlockOnFace=function(t,e,n){this.engineChunk=t;var i=this.pos.a,r=0===e.axis?1:0,s=2===e.axis?1:2;for(i[e.axis]=1===e.axisDelta?a.a-1:0,i[r]=0;i[r]<a.a;i[r]+=1)for(i[s]=0;i[s]<a.a;i[s]+=1)this.recalculateIndex(),n()},t.prototype.eachBlockOnEdge=function(t,e,n,i){this.engineChunk=t;var r=this.pos.a,s=0!==e.axis&&0!==n.axis?0:1!==e.axis&&1!==n.axis?1:2;for(r[e.axis]=1===e.axisDelta?a.a-1:0,r[n.axis]=1===n.axisDelta?a.a-1:0,r[s]=0;r[s]<a.a;r[s]+=1)this.recalculateIndex(),i()},t.prototype.setBlockOnCorner=function(t,e,n,i){this.engineChunk=t;var r=this.pos.a;r[e.axis]=1===e.axisDelta?a.a-1:0,r[n.axis]=1===n.axisDelta?a.a-1:0,r[i.axis]=1===i.axisDelta?a.a-1:0,this.recalculateIndex()},t.prototype.toString=function(){return"BlockPos("+this.pos.toString()+" @ "+(this.engineChunk?this.engineChunk.chunkData.pos.toString():"no-chunk")+")"},t}();e.a=s},function(t,e,n){"use strict";function a(t,e,n,a,r,s){var o=s[0]+s[2]<s[1]+s[3]?1:0,u=a.id,c=n.pos.a[0]|n.pos.a[1]<<5|n.pos.a[2]<<10|u<<15|o<<18,h=Math.floor(15*s[0])|Math.floor(15*s[1])<<4|Math.floor(15*s[2])<<8|Math.floor(15*s[3])<<12|r[0]<<16|r[1]<<20,d=e*i.h;t[d+0]=c,t[d+1]=h}e.a=a;var i=n(0)},function(t,e,n){"use strict";var a=n(1),i=n(5),r=n(6),s=n(14),o=n(7),u=n(4),c=n(16);e.a={id:"TaskGenerateAndMeshChunk",cancel:function(t){r.a(t)},queue:function(t,e){var n;t.toString();return r.b("TaskGenerateAndMeshChunk",function(){(n=i.a.pool.acquire()).setChunkPos(t);var e=c.a.acquire(),a=[u.a.acquire()];return{requestPayload:{chunkPos:[t.a[0],t.a[1],t.a[2]],blockData:n.blocks.buffer,quadIdsByBlockAndSide:e.buffer,initialVertexArrays:a.map(function(t){return t.buffer})},transferableObjects:[n.blocks.buffer,e.buffer].concat(a.map(function(t){return t.buffer}))}},function(t){n.blocks=new Uint8Array(t.blockData),t.unusedVertexArrays.map(function(t){return new Uint32Array(t)}).forEach(function(t){u.a.release(t)});var a=t.quadCount,i=t.vertexArrays.map(function(t){return new Uint32Array(t)}),r=new Uint16Array(t.quadIdsByBlockAndSide);e(n,a,i,r)},function(t){n.blocks=new Uint8Array(t.blockData),i.a.pool.release(n);var e=new Uint16Array(t.quadIdsByBlockAndSide);c.a.release(e),t.unusedVertexArrays.map(function(t){return new Uint32Array(t)}).forEach(function(t){u.a.release(t)}),t.vertexArrays.map(function(t){return new Uint32Array(t)}).forEach(function(t){u.a.release(t)})})},work:function(t,e){var n=t.chunkPos,i=new a.a(n[0],n[1],n[2]),r=new Uint8Array(t.blockData),u=new Uint16Array(t.quadIdsByBlockAndSide),c=t.initialVertexArrays.map(function(t){return new Uint32Array(t)});s.a.generateChunk(i,r),u.fill(0);var h=o.a.drawInternalChunkQuads(r,u,c),d=h.quadCount,f=h.vertexArrays,l=h.unusedVertexArrays;e({blockData:r.buffer,quadCount:d,vertexArrays:f.map(function(t){return t.buffer}),quadIdsByBlockAndSide:u.buffer,unusedVertexArrays:l.map(function(t){return t.buffer})},[r.buffer,u.buffer].concat(f.map(function(t){return t.buffer}),l.map(function(t){return t.buffer})))}}},function(t,e,n){"use strict";var a=n(0),i=n(1),r=n(3),s=n(15),o=new s.a.Noise3d(250).setFractal(2,.5,1.1),u=new s.a.Noise3d(80),c=(new s.a.Noise3d(250),new s.a.NoiseWarp3d(1,o)),h=new s.a.CellNoise(.02);e.a={generateChunk:function(t,e){for(var n=new i.a,s=0,o=0;o<a.a;o+=1){n.x=o+t.x*a.a;for(var u=0;u<a.a;u+=1){n.z=u+t.z*a.a;for(var c=h.sample2sqr(n.x/2,n.z/2),d=c[0],f=c[1],l=0;l<a.a;l+=1){n.y=l+t.y*a.a+30;var p=r.a.byName.air.id;n.y<-10?p=r.a.byName.obsidian.id:n.y<50&&(p=this.terrainGen(n,d,f)),e[s]=p,s+=1}}}},terrainGen:function(t,e,n){var a=(n+1.5)%1,s=new i.a,h=[r.a.byName.stone.id,r.a.byName.dirt.id,r.a.byName.sand.id,r.a.byName.gravel.id,r.a.byName.snow.id,r.a.byName.ice.id,r.a.byName.sandstone.id,r.a.byName.grass.id],d=h[Math.floor(a*h.length)];s.setFrom(t),s=c.warp3(s);var f=o.sample2(s);return f+=.5*u.sample3(s),(f=Math.pow(f,2))>t.y/25?d:r.a.byName.air.id}}},function(t,e,n){"use strict";function a(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(var e=0;e<256;e++){var n;n=1&e?c[e]^255&t:c[e]^t>>8&255,h[e]=h[e+256]=n,d[e]=d[e+256]=u[n%12]}}function i(t,e){var n,a,i,r,s,o=(t+e)*f,u=Math.floor(t+o),c=Math.floor(e+o),p=(u+c)*l,y=t-u+p,k=e-c+p;y>k?(r=1,s=0):(r=0,s=1);var b=y-r+l,v=k-s+l,g=y-1+2*l,x=k-1+2*l,m=d[(u&=255)+h[c&=255]],w=d[u+r+h[c+s]],T=d[u+1+h[c+1]],S=.5-y*y-k*k;n=S<0?0:(S*=S)*S*m.dot2(y,k);var A=.5-b*b-v*v;a=A<0?0:(A*=A)*A*w.dot2(b,v);var B=.5-g*g-x*x;return i=B<0?0:(B*=B)*B*T.dot2(g,x),70*(n+a+i)}function r(t,e,n){var a,i,r,s,o,u,c,f,l,k,b=(t+e+n)*p,v=Math.floor(t+b),g=Math.floor(e+b),x=Math.floor(n+b),m=(v+g+x)*y,w=t-v+m,T=e-g+m,S=n-x+m;w>=T?T>=S?(o=1,u=0,c=0,f=1,l=1,k=0):w>=S?(o=1,u=0,c=0,f=1,l=0,k=1):(o=0,u=0,c=1,f=1,l=0,k=1):T<S?(o=0,u=0,c=1,f=0,l=1,k=1):w<S?(o=0,u=1,c=0,f=0,l=1,k=1):(o=0,u=1,c=0,f=1,l=1,k=0);var A=w-o+y,B=T-u+y,C=S-c+y,I=w-f+2*y,N=T-l+2*y,O=S-k+2*y,M=w-1+3*y,q=T-1+3*y,D=S-1+3*y,E=d[(v&=255)+h[(g&=255)+h[x&=255]]],P=d[v+o+h[g+u+h[x+c]]],V=d[v+f+h[g+l+h[x+k]]],z=d[v+1+h[g+1+h[x+1]]],U=.6-w*w-T*T-S*S;a=U<0?0:(U*=U)*U*E.dot3(w,T,S);var _=.6-A*A-B*B-C*C;i=_<0?0:(_*=_)*_*P.dot3(A,B,C);var W=.6-I*I-N*N-O*O;r=W<0?0:(W*=W)*W*V.dot3(I,N,O);var F=.6-M*M-q*q-D*D;return s=F<0?0:(F*=F)*F*z.dot3(M,q,D),32*(a+i+r+s)}var s=n(1),o=function(){function t(t,e,n){this.x=t,this.y=e,this.z=n}return t.prototype.dot2=function(t,e){return this.x*t+this.y*e},t.prototype.dot3=function(t,e,n){return this.x*t+this.y*e+this.z*n},t}(),u=[new o(1,1,0),new o(-1,1,0),new o(1,-1,0),new o(-1,-1,0),new o(1,0,1),new o(-1,0,1),new o(1,0,-1),new o(-1,0,-1),new o(0,1,1),new o(0,-1,1),new o(0,1,-1),new o(0,-1,-1)],c=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],h=new Array(512),d=new Array(512);a(0);var f=.5*(Math.sqrt(3)-1),l=(3-Math.sqrt(3))/6,p=1/3,y=1/6,k=0,b=function(){function t(t,e){this.scale=t,this.offset=e,this.workVector=new s.a,e?this.offset.setFrom(e):(this.offset=new s.a,this.randomizeOffset()),this.setFractal(1,.5,2)}return t.prototype.randomizeOffset=function(){return k+=123.45,this.offset.x=1e3*r(k,0,0),this.offset.y=1e3*r(0,k,0),this.offset.z=1e3*r(0,0,k),this},t.prototype.setFractal=function(t,e,n){return this.octaves=t,this.persistance=e,this.lacunarity=n,this},t.prototype.clone=function(){var e=new t(this.scale,this.offset);return e.setFractal(this.octaves,this.persistance,this.lacunarity),e},t.prototype.sample3=function(t){var e=1,n=1,a=0,i=this.workVector;i.setFrom(t).add(this.offset).divideScalar(this.scale);for(var s=0;s<this.octaves;s+=1)i.multiplyScalar(n),a+=e*r(i.x,i.y,i.z),e*=this.persistance,n*=this.lacunarity;return a},t.prototype.sample2=function(t){var e=1,n=1,a=0,r=this.workVector;r.setFrom(t).add(this.offset).divideScalar(this.scale);for(var s=0;s<this.octaves;s+=1)r.multiplyScalar(n),a+=e*i(r.x,r.z),e*=this.persistance,n*=this.lacunarity;return a},t}(),v=function(){function t(t,e){this.scale=t,this.noise_x=e.clone().randomizeOffset(),this.noise_y=e.clone().randomizeOffset(),this.noise_z=e.clone().randomizeOffset(),this.workVector=new s.a}return t.prototype.warp3=function(t){return this.workVector.x=t.x+this.scale*this.noise_x.sample3(t),this.workVector.y=t.y+this.scale*this.noise_y.sample3(t),this.workVector.z=t.z+this.scale*this.noise_z.sample3(t),t.setFrom(this.workVector),t},t.prototype.warp2=function(t){return this.workVector.x=t.x+this.scale*this.noise_x.sample2(t),this.workVector.y=t.y+this.scale*this.noise_y.sample2(t),this.workVector.z=t.z+this.scale*this.noise_z.sample2(t),t.setFrom(this.workVector),t},t}(),g=function(){function t(t){this.scale=t,this.noisex=new b(1),this.noisez=new b(1),this.noiseq=new b(1),this.workVector=new s.a,this.winningGridCoord=new s.a}return t.prototype.sample2sqr=function(t,e){t*=this.scale,e*=this.scale;for(var n=Math.floor(t),a=Math.floor(e),i=t-n,r=e-a,s=100,o=-1;o<=1;o+=1)for(var u=-1;u<=1;u+=1){this.workVector.set(n+u,0,a+o);var c=u+.5*this.noisex.sample2(this.workVector)-i,h=o+.5*this.noisez.sample2(this.workVector)-r,d=c*c+h*h;d<s&&(s=d,this.winningGridCoord.setFrom(this.workVector))}return[s,this.noiseq.sample2(this.winningGridCoord)]},t}();e.a={Noise3d:b,NoiseWarp3d:v,CellNoise:g,seed:a,simplex3:r,simplex2:i}},function(t,e,n){"use strict";var a=n(0),i=new(n(2).a)(function(){return new Uint16Array(a.b*a.e)});e.a=i}]);
//# sourceMappingURL=worker.js.map